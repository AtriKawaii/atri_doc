import{_ as s,c as n,o as a,d as l}from"./app.8b88d45c.js";const i=JSON.parse('{"title":"\u7F16\u5199\u63D2\u4EF6","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u5B9A\u4E49\u63D2\u4EF6\u7ED3\u6784","slug":"\u5B9A\u4E49\u63D2\u4EF6\u7ED3\u6784","link":"#\u5B9A\u4E49\u63D2\u4EF6\u7ED3\u6784","children":[]},{"level":2,"title":"\u4E3A\u63D2\u4EF6\u7ED3\u6784\u5B9E\u73B0Plugin","slug":"\u4E3A\u63D2\u4EF6\u7ED3\u6784\u5B9E\u73B0plugin","link":"#\u4E3A\u63D2\u4EF6\u7ED3\u6784\u5B9E\u73B0plugin","children":[]},{"level":2,"title":"\u4E00\u4E2A\u7B80\u5355\u7684\u63D2\u4EF6\u793A\u4F8B","slug":"\u4E00\u4E2A\u7B80\u5355\u7684\u63D2\u4EF6\u793A\u4F8B","link":"#\u4E00\u4E2A\u7B80\u5355\u7684\u63D2\u4EF6\u793A\u4F8B","children":[]}],"relativePath":"dev/plugin/primary/write.md"}'),p={name:"dev/plugin/primary/write.md"},o=l(`<h1 id="\u7F16\u5199\u63D2\u4EF6" tabindex="-1">\u7F16\u5199\u63D2\u4EF6 <a class="header-anchor" href="#\u7F16\u5199\u63D2\u4EF6" aria-hidden="true">#</a></h1><h2 id="\u5B9A\u4E49\u63D2\u4EF6\u7ED3\u6784" tabindex="-1">\u5B9A\u4E49\u63D2\u4EF6\u7ED3\u6784 <a class="header-anchor" href="#\u5B9A\u4E49\u63D2\u4EF6\u7ED3\u6784" aria-hidden="true">#</a></h2><p>\u9996\u5148, \u5B9A\u4E49\u4E00\u4E2A\u7ED3\u6784\u4F53(struct)\u6216\u679A\u4E3E(enum)\u4F5C\u4E3A\u63D2\u4EF6\u7684\u7ED3\u6784</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">atri_plugin</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">plugin</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">MyAwesomePlugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyPlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    listener</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">ListenerGuard</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>\u5B8F\u7684\u4F7F\u7528</summary><p>\u6BCF\u4E2A\u63D2\u4EF6\u90FD\u9700\u8981\u4F7F\u7528\u5B8F\u6765\u6807\u8BB0, \u4E14\u53EA\u80FD\u6807\u8BB0\u4E00\u4E2A\u7ED3\u6784\u4F5C\u4E3A\u63D2\u4EF6</p><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki has-focused-lines"><code><span class="line has-focus"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">atri_plugin</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">plugin</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">MyAwesomePlugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyPlugin</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u53C2\u6570<code>name</code>\u4E3A\u63D2\u4EF6\u540D\u79F0, \u82E5\u6CA1\u6709\u6307\u5B9A\u63D2\u4EF6\u540D, \u5219\u9ED8\u8BA4\u63D2\u4EF6\u540D\u4E3A<code>Struct_plugin</code></p><p>\u5982\u4E0A\u8FF0\u63D2\u4EF6\u4E0D\u6307\u5B9A\u540D\u79F0\u5219\u4E3A<code>MyPlugin_plugin</code></p></details><h2 id="\u4E3A\u63D2\u4EF6\u7ED3\u6784\u5B9E\u73B0plugin" tabindex="-1">\u4E3A\u63D2\u4EF6\u7ED3\u6784\u5B9E\u73B0<code>Plugin</code> <a class="header-anchor" href="#\u4E3A\u63D2\u4EF6\u7ED3\u6784\u5B9E\u73B0plugin" aria-hidden="true">#</a></h2><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> atri_plugin</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyPlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#676E95;">    //...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="\u4E00\u4E2A\u7B80\u5355\u7684\u63D2\u4EF6\u793A\u4F8B" tabindex="-1">\u4E00\u4E2A\u7B80\u5355\u7684\u63D2\u4EF6\u793A\u4F8B <a class="header-anchor" href="#\u4E00\u4E2A\u7B80\u5355\u7684\u63D2\u4EF6\u793A\u4F8B" aria-hidden="true">#</a></h2><div class="language-rust"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> atri_plugin</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">Plugin</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">atri_plugin</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">plugin</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">MyAwesomePlugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)]</span></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyPlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    listener</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Option</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">ListenerGuard</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">impl</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Plugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyPlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> Self </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        Self </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> listener</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">None</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">enable</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">info!</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Enable my plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> guard </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Listener</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">listening_on_always</span><span style="color:#89DDFF;">(|</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">GroupMessageEvent</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">move</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> message </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">message</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> message</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">to_string</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">123</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> chain </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MessageChainBuilder</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">new</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">                chain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push_str</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">321</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push_str</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">114514</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> _ </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">group</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">send_message</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">chain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">()).</span><span style="color:#89DDFF;">await</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">});</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">listener </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Some</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">guard</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">disable</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">info!</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Disable my plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div>`,9),e=[o];function t(c,r,D,F,y,C){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{i as __pageData,u as default};
